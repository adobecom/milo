/* eslint-disable */
(()=>{"use strict";const e=(e,t,n)=>{const s=document.createElement("section");return s.ariaLabel="Brand Concierge Popup Frame",s.className="bc-popup-frame",s.style.zIndex=e.zIndex,s.style.display="flex",s.style.flexDirection="column",s.style.width=e.chatInterface.width,s.style.height=e.chatInterface.height,s.style.borderRadius=e.chatInterface.borderRadius,s.style.backgroundColor=e.chatInterface.background.color,s.style.position="fixed",s.style.left="50%",s.style.transform="translateX(-50%)",s.style.filter="drop-shadow(0 2px 8px rgba(0, 0, 0, 0.1))",s.style.webkitFontSmoothing="antialiased",n.style.width=e.chatInterface.width,n.style.height=`calc(100% - ${e.chatInterface.chatHeader.height})`,s.appendChild(((e,t)=>{const n=document.createElement("div");n.className="bc-popup-frame-header",n.style.boxSizing="border-box",n.style.height=e.chatInterface.chatHeader.height,n.style.borderTopLeftRadius=e.chatInterface.borderRadius,n.style.borderTopRightRadius=e.chatInterface.borderRadius,n.style.backgroundColor=e.chatInterface.chatHeader.background.color,n.style.color=e.chatInterface.chatHeader.font.color,n.style.fontFamily=e.chatInterface.chatHeader.font.family,n.style.fontSize=e.chatInterface.chatHeader.font.size,n.style.fontWeight=e.chatInterface.chatHeader.font.weight,n.style.padding="10px 16px",n.style.display="flex",n.style.justifyContent="space-between",n.style.alignItems="center",n.style.display="none";const s=document.createElement("span");s.textContent=e.chatInterface.chatHeader.label,s.className="bc-popup-frame-header-title",s.style.lineHeight="normal";const o=document.createElement("button");o.className="bc-popup-frame-header-close-button",o.style.boxSizing="content-box",o.style.width="14px",o.style.height="14px",o.style.backgroundColor="transparent",o.style.border="none",o.style.padding="0",o.style.cursor="pointer",o.addEventListener("click",t);const i=document.createElement("img");return i.src="https://assets.thdstatic.com/images/v1/caret-white.svg",i.alt="Minimize Chat",i.style.width="14px",i.style.height="14px",i.style.display="block",i.style.transform="rotate(90deg)",o.appendChild(i),n.appendChild(s),n.appendChild(o),n})(e,t)),s.appendChild(n),s},t=class{constructor(){this.element=document.createElement("div"),this.element.className="bc-messages-container",this.element.style.display="flex",this.element.style.marginBottom="16px",this.element.style.overflow="hidden",this.element.style.overflowY="auto",this.messagesElement=document.createElement("div"),this.messagesElement.className="bc-messages",this.messagesElement.innerHTML="\n      <style>\n        .bc-messages {\n          display: flex;\n          flex-direction: column;\n          flex: 1;\n          padding: 0 0 10px 0;\n        }\n        .bc-message::-webkit-scrollbar {\n          display: none;\n        }\n      </style>\n    ",this.messagesElement.style.display="flex",this.messagesElement.style.flexDirection="column",this.element.appendChild(this.messagesElement)}addResponse=e=>{this.messagesElement.appendChild(e.element),e.element.scrollIntoView({behavior:"smooth",block:"start"})};removeResponse(e){return!(!e||!e.element||e.element.parentNode!==this.element.firstChild||(this.messagesElement.removeChild(e.element),0))}hasResponse(e){return e&&e.element&&e.element.parentNode===this.element.firstChild}},n=class{constructor(e,t){this.isListening=!1,this.element=document.createElement("div"),this.element.className="bc-input-container",this.element.style.display="flex",this.element.style.flexDirection="column",this.element.style.alignItems="center",this.inputContainer=document.createElement("div"),this.inputContainer.className="bc-input",this.inputContainer.style.display="flex",this.inputContainer.style.alignItems="center",this.inputContainer.style.height="64px",this.inputContainer.style.width="100%",this.inputContainer.style.borderRadius="64px",this.inputContainer.style.backgroundColor="#FFFFFF",this.inputContainer.style.outline="2px solid #DADADA",this.inputElement=this.createInputElement(e,t),this.sendVioceButtonElement=this.sendVioceButtonElement(e),this.sendButtonElement=this.createSendButtonElement(e,(()=>{t(this.inputElement.value),this.inputElement.value="",this.sendButtonElement.disabled=!0})),this.sendButtonElement.disabled=!0,this.inputContainer.appendChild(this.inputElement),this.inputContainer.appendChild(this.sendVioceButtonElement),this.inputContainer.appendChild(this.sendButtonElement),this.element.appendChild(this.inputContainer),this.disclaimerElement=document.createElement("div"),this.disclaimerElement.className="bc-disclaimer",this.disclaimerElement.innerHTML=`\n      <style>\n        .bc-disclaimer {\n          font-family: ${e.chatInterface.chatControls.input.font.family};\n          font-size: 14px;\n          text-align: center;\n          margin-top: 16px;\n          color: #292929;\n        }\n      </style>\n      AI responses may be inaccurate or misleading. Be sure to double check answers and sources.\n    `,this.element.appendChild(this.disclaimerElement)}createInputElement=(e,t)=>{const n=document.createElement("input");return n.className="bc-chat-input",n.type="text",n.placeholder=e.chatInterface.chatControls.input.placeholder.label,n.innerHTML=`\n      <style>\n        .bc-chat-input {\n          background-color: transparent;\n          flex: 1;\n          padding: 24px;\n          border-width: 0;\n          font-family: ${e.chatInterface.chatControls.input.font.family};\n          font-size: ${e.chatInterface.chatControls.input.font.size};\n          line-height: 20.8px;\n        }\n\n        .bc-chat-input::placeholder {\n          color: #292929;\n        }\n\n        .bc-chat-input:focus-visible {\n          outline: none;\n        }\n\n        .bc-chat-input:disabled {\n          background-color: ${e.chatInterface.chatControls.input.disabled.background.color};\n        }\n      </style>\n    `,n.addEventListener("keydown",(e=>{n.value&&"Enter"===e.key&&(this.sendButtonElement.classList.add("in-progress"),t(n.value),n.value="")})),n.addEventListener("input",(()=>{this.sendButtonElement.disabled=!n.value})),n.addEventListener("focus",(()=>{this.inputContainer.style.outline="2px solid #131313"})),n.addEventListener("blur",(()=>{this.inputContainer.style.outline="none"})),n};sendVioceButtonElement=e=>{const t=document.createElement("button");t.className="bc-send-voice-button",t.innerHTML=`\n      <style>\n        /* Base button styles */\n        .bc-send-voice-button {\n          width: 48px;\n          height: 48px;\n          margin-right: 8px;\n          border: 2px solid #D5D5D5;\n          border-radius: 24px;\n          background-color: rgba(255, 255, 255, 0.8);\n          color: ${e.chatInterface.chatControls.button.font.color};\n          font-family: ${e.chatInterface.chatControls.button.font.family};\n          font-size: ${e.chatInterface.chatControls.button.font.size};\n          font-weight: ${e.chatInterface.chatControls.button.font.weight};\n          line-height: normal;\n          cursor: pointer;\n        }\n\n        /* Interactive states */\n        .bc-send-voice-button:hover:not(.listening):not(:disabled) {\n          background-color: #E9E9E9;\n          border-color: #C6C6C6;\n        }\n\n        .bc-send-voice-button:disabled {\n          border-color: #C6C6C6;\n          cursor: default;\n          opacity: 0.5;\n        }\n\n        .bc-send-voice-button:disabled svg path {\n          fill: #C6C6C6;\n        }\n\n        /* Focus styles */\n        .bc-send-voice-button:focus-visible:not(.listening) {\n          outline: none;\n          background-color: #E9E9E9;\n          border-color: #C6C6C6;\n          position: relative;\n        }\n        \n        .bc-send-voice-button:focus-visible:not(.listening)::after {\n          content: '';\n          position: absolute;\n          top: 50%;\n          left: 50%;\n          transform: translate(-50%, -50%);\n          border-radius: 50%;\n          width: 56px;\n          height: 56px;\n          border: 2px solid #4B75FF;\n          pointer-events: none;\n        }\n\n        /* Listening state */\n        .bc-send-voice-button.listening {\n          border-color: #5258E4;\n          outline: none;\n          position: relative;\n          box-shadow: 0 0 0 0 rgba(85, 91, 231, 0.4);\n          animation: pulse-breathing 2s infinite cubic-bezier(0.4, 0, 0.6, 1);\n        }\n\n        .bc-send-voice-button.listening::after {\n          content: none;\n        }\n\n        /* Breathing animation */\n        @keyframes pulse-breathing {\n          0% { box-shadow: 0 0 0 2px rgba(85, 91, 231, 0.4); }\n          50% { box-shadow: 0 0 0 6px rgba(85, 91, 231, 0.58); }\n          100% { box-shadow: 0 0 0 2px rgba(85, 91, 231, 0.4); }\n        }\n      </style>\n      <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">\n        <path d="M12.0002 15.3002C9.35351 15.3002 7.2002 13.1475 7.2002 10.5002V6.0002C7.2002 3.35294 9.35351 1.2002 12.0002 1.2002C14.6469 1.2002 16.8002 3.35294 16.8002 6.0002V10.5002C16.8002 13.1475 14.6469 15.3002 12.0002 15.3002ZM12.0002 3.0002C10.3461 3.0002 9.0002 4.3455 9.0002 6.0002V10.5002C9.0002 12.1549 10.3461 13.5002 12.0002 13.5002C13.6543 13.5002 15.0002 12.1549 15.0002 10.5002V6.0002C15.0002 4.3455 13.6543 3.0002 12.0002 3.0002Z" fill="#222222"/>\n        <path d="M19.4996 8.77979C19.0027 8.77979 18.5996 9.18291 18.5996 9.67979V10.5001C18.5996 14.1388 15.6389 17.1001 11.9996 17.1001C8.36036 17.1001 5.39961 14.1388 5.39961 10.5001V9.67979C5.39961 9.18291 4.99648 8.77979 4.49961 8.77979C4.00274 8.77979 3.59961 9.18291 3.59961 9.67979V10.5001C3.59961 14.8272 6.88965 18.3994 11.0996 18.8503V21.0001H7.19961C6.70274 21.0001 6.29961 21.4032 6.29961 21.9001C6.29961 22.397 6.70274 22.8001 7.19961 22.8001H16.7996C17.2965 22.8001 17.6996 22.397 17.6996 21.9001C17.6996 21.4032 17.2965 21.0001 16.7996 21.0001H12.8996V18.8503C17.1096 18.3994 20.3996 14.8272 20.3996 10.5001V9.67979C20.3996 9.18291 19.9965 8.77979 19.4996 8.77979Z" fill="#222222"/>\n      </svg>\n    `;const n=window.SpeechRecognition||window.webkitSpeechRecognition;if(n){const e=new n;e.continuous=!1,e.interimResults=!1,e.onresult=e=>{const{transcript:n}=e.results[0][0];this.inputElement.value=n,this.inputElement.dispatchEvent(new Event("input",{bubbles:!0})),this.isListening=!1,t.classList.remove("listening"),this.inputElement.focus()},e.onend=()=>{this.isListening=!1,t.classList.remove("listening"),this.inputElement.focus()},t.addEventListener("click",(()=>{this.isListening?(e.stop(),this.isListening=!1,t.classList.remove("listening")):(e.start(),this.isListening=!0,t.classList.add("listening"))}))}return t};createSendButtonElement=(e,t)=>{const n=document.createElement("button");return n.className="bc-send-button",n.innerHTML=`\n      <style>\n        /* Base button styles */\n        .bc-send-button {\n          width: 48px;\n          height: 48px;\n          margin-right: 8px;\n          border: none;\n          border-radius: 24px;\n          background-color: ${e.chatInterface.chatControls.button.background.color};\n          color: ${e.chatInterface.chatControls.button.font.color};\n          font-family: ${e.chatInterface.chatControls.button.font.family};\n          font-size: ${e.chatInterface.chatControls.button.font.size};\n          font-weight: ${e.chatInterface.chatControls.button.font.weight};\n          line-height: normal;\n          cursor: pointer;\n          display: flex;\n          align-items: center;\n          justify-content: center;\n          position: relative;\n        }\n\n        /* Interactive states */\n        .bc-send-button:hover:not(.listening):not(:disabled):not(.in-progress) {\n          background-color: #4046CA;\n        }\n\n        .bc-send-button:disabled {\n          background-color: #E6E6E6;\n          cursor: default;\n          color: #999999;\n        }\n\n        /* Focus styles */\n        .bc-send-button:focus-visible {\n          outline: none;\n          position: relative;\n          background-color: #4046CA;\n        }\n        \n        .bc-send-button:focus-visible::after {\n          content: '';\n          position: absolute;\n          top: 50%;\n          left: 50%;\n          transform: translate(-50%, -50%);\n          border-radius: 50%;\n          width: 56px;\n          height: 56px;\n          border: 2px solid #4046CA;\n          pointer-events: none;\n        }\n\n        /* Progress state */\n        .bc-send-button.in-progress {\n          background-color: #555BE7;\n          cursor: default;\n        }\n\n        .bc-send-button.in-progress .send-icon {\n          display: none;\n        }\n\n        .bc-send-button.in-progress .progress-circle {\n          display: block;\n        }\n\n        /* Progress circle */\n        .bc-send-button .progress-circle {\n          display: none;\n          width: 14px;\n          height: 14px;\n          border-radius: 50%;\n          border: 2px solid rgba(255, 255, 255, 0.3);\n          border-top-color: white;\n          animation: rotate 1s linear infinite;\n        }\n\n        @keyframes rotate {\n          from { transform: rotate(0deg); }\n          to { transform: rotate(360deg); }\n        }\n      </style>\n      <svg class="send-icon" width="20" height="20" viewBox="0 0 20 20" fill="currentColor" xmlns="http://www.w3.org/2000/svg">\n        <path d="M18.6485 9.9735C18.6482 9.67899 18.4769 9.41106 18.2059 9.29056L4.05752 2.93282C3.80133 2.8175 3.50129 2.85583 3.28171 3.03122C3.06178 3.20765 2.95889 3.49146 3.01516 3.76733L4.28678 10.008L3.06488 16.2384C3.0162 16.4852 3.09492 16.738 3.27031 16.9134C3.29068 16.9337 3.31278 16.9531 3.33522 16.9714C3.55619 17.1454 3.85519 17.182 4.11069 17.066L18.2086 10.6578C18.4773 10.5356 18.6489 10.268 18.6485 9.9735ZM14.406 9.22716L5.66439 9.25379L4.77705 4.90084L14.406 9.22716ZM4.81711 15.0973L5.6694 10.7529L14.4323 10.7264L4.81711 15.0973Z"/>\n      </svg>\n      <div class="progress-circle"></div>\n    `,n.addEventListener("click",(()=>{n.classList.add("in-progress"),t()})),n};resetChatControls=()=>{this.inputElement.disabled=!1,this.inputElement.value="",this.inputElement.focus(),this.sendButtonElement.disabled=!0,this.sendButtonElement.classList.remove("in-progress"),this.sendVioceButtonElement.disabled=!1};disableChatControls=()=>{this.inputElement.disabled=!0,this.sendButtonElement.disabled=!0,this.sendVioceButtonElement.disabled=!0}},s=class{constructor(e,t,n){this.responseElement=((e,t,n)=>{const s=document.createElement("div");return s.style.width="fit-content",s.style.minHeight="53px",s.style.padding="16px 24px",s.style.borderRadius=e.chatInterface.chatBody.response.borderRadius,s.style.lineHeight="21px",s.style.boxSizing="border-box",t?(s.style.backgroundColor=e.chatInterface.chatBody.response.concierge.background.color,s.style.color=e.chatInterface.chatBody.response.concierge.font.color):(s.style.backgroundColor=e.chatInterface.chatBody.response.user.background.color,s.style.color=e.chatInterface.chatBody.response.user.font.color),s.appendChild(n),s})(e,t,n),this.element=((e,t)=>{const n=document.createElement("div");return n.className="bc-response-container",n.style.display="flex",n.style.paddingTop="12px",n.style.fontFamily=e.chatInterface.chatBody.response.font.family,n.style.fontSize=e.chatInterface.chatBody.response.font.size,n.style.justifyContent=t?"left":"right",n})(e,t),this.element.appendChild(this.responseElement)}replaceContent(e,t){t&&(this.responseElement.style.padding="0"),this.responseElement.replaceChildren(),this.responseElement.appendChild(e)}},o=e=>{const t=document.createElement("div");return t.style.width="8px",t.style.height="8px",t.style.borderRadius="50%",t.style.opacity="1",t.style.transition="opacity 1s ease-in-out",t.style.animation="fade 1s infinite",t.style.backgroundColor=e.chatInterface.chatBody.response.concierge.loading.color,t.innerHTML="\n    <style>\n      @keyframes fade {\n        0%,\n        100% {\n          opacity: 1;\n        }\n        50% {\n          opacity: 0;\n        }\n      }\n    </style>\n  ",t},i=e=>(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=e.replace(/\n\s*\n/g,"\n")).replace(/\t/g,"    ")).replace(/^[\s]*###### (.*$)/gim,"<h6>$1</h6>")).replace(/^[\s]*##### (.*$)/gim,"<h5>$1</h5>")).replace(/^[\s]*#### (.*$)/gim,"<h4>$1</h4>")).replace(/^[\s]*### (.*$)/gim,"<h3>$1</h3>")).replace(/^[\s]*## (.*$)/gim,"<h2>$1</h2>")).replace(/^[\s]*# (.*$)/gim,"<h1>$1</h1>")).replace(/\*\*\*(.*)\*\*\*/gim,"<b><i>$1</i></b>")).replace(/\*\*(.*)\*\*/gim,"<b>$1</b>")).replace(/\*(.*)\*/gim,"<i>$1</i>")).replace(/^[\s]*\d+\.\s+(.*$)/gim,"<ol><li>$1</li></ol>")).replace(/<\/ol>\s*<ol>/gim,"")).replace(/^[\s]*-\s+(.*$)/gim,"<ul><li>$1</li></ul>")).replace(/<\/ul>\s*<ul>/gim,"")).replace(/^> (.*$)/gim,"<blockquote>$1</blockquote>")).replace(/```([^`]+)```/gim,"<pre><code>$1</code></pre>")).replace(/`([^`]+)`/gim,"<code>$1</code>")).replace(/^\s*[-*]{3,}\s*$/gim,"<hr>")).replace(/\[([^\]]+)\]\(([^)]+)\)/gim,'<a href="$2" target="_blank" style="color: #3B63FB;">$1</a>')).replace(/!\[([^\]]*)\]\(([^)]+)\)/gim,'<img src="$2" alt="$1">')).replace(/\n/gim,"<br>")).trim(),l=(e,t,n)=>{const s=document.createElement("div");return s.className="bc-prompt-suggestions",s.style.display="flex",s.style.flexDirection="column",s.style.gap="10px",s.style.alignItems="left",s.style.maxWidth="620px",t.options?.forEach((t=>{const o=((e,t,n)=>{const s=document.createElement("button");return s.className="bc-prompt-suggestion",s.style.display="flex",s.style.gap="8px",s.style.fontSize="16px",s.style.padding="10px",s.style.backgroundColor="white",s.style.border="0",s.style.borderRadius="10px",s.style.color=e.chatInterface.link.color,s.style.fontFamily=e.chatInterface.chatBody.response.font.family,s.style.cursor="pointer",s.innerHTML="\n    <style>\n      .bc-prompt-suggestion:focus-visible {\n        outline: 2px solid #4b75ff;\n        outline-offset: 2px;\n      }\n    </style>\n  ",s.appendChild((()=>{const e=document.createElement("img");return e.src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTgiIGhlaWdodD0iMTkiIHZpZXdib3g9IjAgMCAxOCAxOSIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cGF0aCBkPSJNMTMgNi41NjQ0NUwxNi41IDEwLjA2NDVMMTMgMTMuNTY0NU0xNiAxMC4wNjQ1SDhDNC41IDEwLjA2NDUgMi41IDkuMDY0NDUgMi41IDUuMDY0NDUiIHN0cm9rZT0iIzI5MjkyOSIgc3Ryb2tlLXdpZHRoPSIxLjc1IiBzdHJva2UtbGluZWNhcD0icm91bmQiIHN0cm9rZS1saW5lam9pbj0icm91bmQiPjwvcGF0aD48L3N2Zz4=",e})()),s.appendChild(document.createTextNode(t)),s.addEventListener("mouseover",(()=>{s.style.backgroundColor="#e9e9e9"})),s.addEventListener("mouseout",(()=>{s.style.backgroundColor="white"})),s.addEventListener("click",(()=>n&&n(t))),s})(e,t,n);s.appendChild(o)})),s},a=(e,t,n)=>t?t.map(((s,o)=>{if("text"===s.type)return((e,t)=>{const n=document.createElement("div");n.className="bc-text",n.style.maxWidth="572px";const s=t.text.replace(/\*\*\[(.*?)\]\*\*/g,"<strong>$1</strong>"),o=i(s);return n.innerHTML=o,n})(0,s);if("options"===s.type)return l(e,s,n?.respondToUser);if("rich-text-card"===s.type)return((e,t)=>{const n=document.createElement("div");if(n.className="bc-product",n.style.display="flex",n.style.flexDirection="column",n.style.backgroundColor="Creative Cloud Photo Plan"===t.title?"#1B49F3":t.backgroundColor??"#000000",n.style.borderRadius="16px",n.style.width="620px",n.style.overflow="hidden",t.videoUrl){const e=document.createElement("div");e.style.width="100%",e.style.height="Creative Cloud Photo Plan"===t.title?"280px":"320px",e.style.overflow="hidden",e.style.position="relative",e.style.display="flex",e.style.justifyContent="center",e.style.alignItems="center";const s=document.createElement("video");s.src=t.videoUrl,s.autoplay=!0,s.loop=!0,s.muted=!0,s.playsInline=!0,s.controls=!1,s.style.width="Creative Cloud Photo Plan"===t.title?"auto":"100%",s.style.height="100%",s.style.objectFit="cover",s.style.position="relative",e.appendChild(s),n.appendChild(e)}else if(t.backgroundImageUrl){const e=document.createElement("div");e.style.width="100%",e.style.height="320px",e.style.overflow="hidden";const s=document.createElement("img");s.src=t.backgroundImageUrl,s.alt=t.title||"Product image",s.style.width="100%",s.style.height="100%",s.style.objectFit="cover",s.style.display="block",e.appendChild(s),n.appendChild(e)}const s=document.createElement("div");s.style.display="flex",s.style.flexDirection="column",s.style.padding="24px",s.style.borderRadius="16px",s.style.backgroundColor="white",s.style.marginLeft="16px",s.style.marginRight="16px",s.style.marginBottom="16px";const o=document.createElement("div");if(o.style.display="flex",o.style.alignItems="center",o.style.gap="8px",t.logo){const e=document.createElement("img");e.src=t.logo,e.alt=t.title,e.style.width="24px",e.style.height="24px",o.appendChild(e)}const i=document.createElement("div");i.innerHTML=t.title,i.style.fontSize="18px",i.style.fontWeight="700",o.appendChild(i),s.appendChild(o);const l=document.createElement("div");return l.innerHTML=t.description,l.style.fontSize="16px",l.style.fontWeight="400",l.style.lineHeight="150%",l.style.marginTop="16px",l.style.marginBottom="16px",s.appendChild(l),a(e,t.items).forEach((e=>s.appendChild(e))),n.appendChild(s),n})(e,s);if("h2"===s.type)return((e,t)=>{const n=document.createElement("div");return n.innerHTML=t.text,n.style.fontSize="16px",n.style.fontWeight="700",n.style.lineHeight="150%",n})(0,s);if("bullet-list"===s.type)return((e,t)=>{const n=document.createElement("ul");return n.style.fontSize="16px",n.style.fontWeight="400",n.style.listStyleType="none",n.style.padding="0",n.style.margin="0",n.style.lineHeight="150%",n.innerHTML=t.items.map((e=>e?.startsWith("✅")?`<li>${e}</li>`:`<li>✅ ${e}</li>`)).join(""),n.style.marginBottom="16px",n})(0,s);if("button-group"===s.type)return((e,t)=>{const n=document.createElement("div");return n.style.display="flex",n.style.gap="8px",n.style.marginTop="16px",a(e,t.items).forEach((e=>n.appendChild(e))),n})(e,s);if("action-button"===s.type)return((e,t)=>{const n=document.createElement("button");return n.className="bc-action-button",n.style.padding="9px 20px 11px 20px",n.style.height="40px",n.style.backgroundColor="white",n.style.border="2px solid #DADADA",n.style.borderRadius="20px",n.style.color=e.chatInterface.link.color,n.style.fontWeight=700,n.style.fontFamily=e.chatInterface.chatBody.response.font.family,n.style.display="flex",n.style.alignItems="center",n.style.cursor="pointer",n.style.fontSize="16px",n.innerHTML=`\n    <style>\n      .bc-action-button:focus-visible {\n        outline: 2px solid  #4b75ff;\n        outline-offset: 2px;\n      }\n    </style>\n\n    ${t.text}\n  `,t.primary?(n.style.backgroundColor=e.chatInterface.link.color,n.style.color="white",n.style.borderColor=e.chatInterface.link.color):(n.addEventListener("mouseover",(()=>{n.style.backgroundColor="#e9e9e9"})),n.addEventListener("mouseout",(()=>{n.style.backgroundColor="white"}))),n.addEventListener("click",(()=>{window.open(t.url,"_blank")})),n})(e,s);if("markdown"===s.type){const e=((e,t)=>{const n=document.createElement("div");return n.className="bc-markdown",n.style.maxWidth="572px",n.style.fontSize="16px",n.innerHTML=i(t?.content),n})(0,s);return o>0&&"markdown"===t[o-1].type&&(e.style.marginTop="16px"),e}const r=document.createElement("div");return r.innerHTML=`NOT IMPLEMENTED: ${s.type}`,r})).filter((e=>void 0!==e)):[],r=({brandStyling:e,message:t,onSelectPrebuiltMessage:n})=>{const{items:s}=t,o=document.createElement("div");return o.className="bc-response-content-container",o.style.display="flex",o.style.flexDirection="column",o.style.gap="16px",a(e,s,{respondToUser:n}).forEach((e=>{o.appendChild(e)})),o},c="https://experience-platform-aep-gen-ai-assistant-exp154.corp.ethos12-stage-va7.ethos.adobe.net/copilot/chats",d=class{constructor(e,s){this.brandStyling=e,this.alloyInstanceName=s,this.chatId=null,this.chatMessages=new t,this.chatInputContainer=new n(e,this.sendUserMessage),this.element=document.createElement("div"),this.element.style.display="flex",this.element.style.flexDirection="column",this.element.appendChild(this.chatMessages.element),this.element.appendChild(this.chatInputContainer.element),this.chatInputContainer.resetChatControls(),this.startConversation()}startConversation=()=>{setTimeout((()=>this.chatInputContainer.resetChatControls()),100)};sendUserMessage=e=>{if(this.chatInputContainer.disableChatControls(),this.addUserResponse(e),window.skipConciergeResponseDelay)this.fetchAndDisplayConciergeResponse(e);else{const t=1250,n=750,s=Math.floor(Math.random()*(t-n+1))+n;setTimeout((()=>this.fetchAndDisplayConciergeResponse(e)),s)}};fetchConciergeResponse=e=>{if(this.alloyInstanceName)return window[this.alloyInstanceName]("sendBrandConciergeEvent",{message:e});const t=this.chatId?`${c}/${this.chatId}/interactions`:c,n=new URL(window.location.href),s=new URLSearchParams(n.search).get("persona");return fetch(t,{method:"POST",headers:{"Content-Type":"application/vnd.adobe.copilot.v1+json;charset=UTF-8","x-api-key":"bc-api-key","x-gw-ims-org-id":"E38130325FF373D60A494210@AdobeOrg"},body:JSON.stringify({message:e,context:{targetedSegment:s||""}})}).then((e=>e.json())).then((e=>(!this.chatId&&e.id&&(this.chatId=e.id),e)))};fetchAndDisplayConciergeResponse=e=>{const t=this.addConciergeLoadingResponse();this.scrollElementIntoView(t.element);let n=this.createErrorResponseContentContainerElement(),o=t.element,i=!1,l=!1;this.fetchConciergeResponse(e).then((e=>{const a=e?.interaction?.response[0];if(a){const e=a.items[0]?.type?a.items:a.items[0]?.items;if(e&&e.length>0)return this.chatMessages.removeResponse(t),void e.forEach(((e,t)=>{i=!1,l=!1,"rich-text-card"===e.type?i=!0:"options"===e.type&&(l=!0);const n=r({brandStyling:this.brandStyling,message:{items:[e]},onSelectPrebuiltMessage:e=>this.sendUserMessage(e)}),a=new s(this.brandStyling,!0,n);i?a.responseElement.style.padding="0":l&&(a.responseElement.style.padding="0",a.responseElement.style.backgroundColor="transparent"),this.chatMessages.addResponse(a),0===t&&(o=a.element)}));n=r({brandStyling:this.brandStyling,message:a,onSelectPrebuiltMessage:e=>this.sendUserMessage(e)}),o??=this.lastUserResponse?.element}})).catch((()=>{})).finally((()=>{this.chatMessages.hasResponse(t)&&t.replaceContent(n,i),this.scrollElementIntoView(o),this.chatInputContainer.resetChatControls()}))};createErrorResponseContentContainerElement=()=>r({brandStyling:this.brandStyling,message:{items:[{type:"text",text:"Sorry, I am unable to assist you at the moment. Please try again later!"}]}});addUserResponse=e=>{const t=document.createElement("div");t.className="bc-user-response-content",t.innerHTML=e,t.style.maxWidth="572px",t.style.overflowWrap="break-word",t.style.whiteSpace="pre-wrap",this.lastUserResponse=new s(this.brandStyling,!1,t),this.chatMessages.addResponse(this.lastUserResponse)};addConciergeLoadingResponse=()=>{const e=(e=>{const t=o(e),n=o(e),s=o(e),i=document.createElement("div");i.className="bc-loading";const l=document.createElement("div");l.style.display="flex",l.style.gap="6px",l.style.marginRight="8px",l.appendChild(t),l.appendChild(n),l.appendChild(s);const a=document.createElement("span");return a.textContent="Generating from Adobe's trusted resources",i.appendChild(l),i.appendChild(a),i.style.height="100%",i.style.display="flex",i.style.justifyContent="center",i.style.alignItems="center",t.style.animationDelay="0s",n.style.animationDelay="0.25s",s.style.animationDelay="0.5s",i})(this.brandStyling),t=new s(this.brandStyling,!0,e);return this.chatMessages.addResponse(t),t};scrollElementIntoView=e=>{e.scrollIntoView({behavior:"smooth",block:"start"})}};(new class{constructor(){this.alloyInstanceName=null;let e=document.getElementById("adobe-brand-concierge-mount-point");e||(e=document.createElement("div"),document.body.appendChild(e)),this.shadowElement=e}addChatButtonToShadowElement(e,t){e.innerHTML="";const n=((e,t)=>{const n=document.createElement("button");return n.appendChild(document.createTextNode(e.chatButton.label)),n.style.zIndex=e.zIndex,n.style.width=e.chatButton.width,n.style.height=e.chatButton.height,n.style.color=e.chatButton.font.color,n.style.backgroundColor=e.chatButton.background.color,n.style.borderWidth=0,n.style.borderRadius=e.chatButton.borderRadius,n.style.fontFamily=e.chatButton.font.family,n.style.fontSize=e.chatButton.font.size,n.style.fontWeight=e.chatButton.font.weight,n.style.padding="24px",n.style.position="fixed",n.style.bottom="36px",n.style.left="50%",n.style.transform="translateX(-50%)",n.addEventListener("mouseover",(()=>{n.style.backgroundColor=e.chatButton.background.hover.color,n.style.textDecoration=e.chatButton.font.hover.textDecoration})),n.addEventListener("mouseout",(()=>{n.style.backgroundColor=e.chatButton.background.color,n.style.textDecoration="none"})),n.addEventListener("click",t),n})(t,(()=>this.addPopupFrameToShadowElement(e,t)));e.appendChild(n)}addPopupFrameToShadowElement(t,n){t.innerHTML="";const s=e(n,(()=>this.addChatButtonToShadowElement(t,n)),new d(n,this.alloyInstanceName).element);t.appendChild(s)}addFrameToShadowElement(e,t){e.innerHTML="";const n=new d(t,this.alloyInstanceName).element;e.appendChild(n)}integrateWithWebSDK(){window.addEventListener("alloy-brand-concierge-instance",(e=>{const{instanceName:t}=e.detail;this.alloyInstanceName=t})),window.dispatchEvent(new CustomEvent("adobe-brand-concierge-prompt-loaded"))}initWebAgent(){fetch("https://experience-stage.adobe.net/solutions/experience-platform-brand-concierge-web-agent/static-assets/brandStyling/DotComStyling.json").then((e=>e.json())).then((e=>{document.getElementById("adobe-brand-concierge-mount-point")?this.addFrameToShadowElement(this.shadowElement,e):this.addChatButtonToShadowElement(this.shadowElement,e),this.integrateWithWebSDK()}))}render(){this.initWebAgent()}}).render()})();