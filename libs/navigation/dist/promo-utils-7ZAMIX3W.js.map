{
  "version": 3,
  "sources": ["../../features/personalization/promo-utils.js"],
  "sourcesContent": ["import { getMetadata, getConfig } from '../../utils/utils.js';\n\nconst GMTStringToLocalDate = (gmtString) => new Date(`${gmtString}+00:00`);\n\nconst APAC = ['au', 'cn', 'hk_en', 'hk_zh', 'id_en', 'id_id', 'in', 'in_hi', 'kr', 'my_en', 'my_ms', 'nz', 'ph_en', 'ph_fil', 'sg', 'th_en', 'th_th', 'tw', 'vn_en', 'vn_vi'];\nconst EMEA = ['ae_en', 'ae_ar', 'africa', 'at', 'be_en', 'be_fr', 'be_nl', 'bg', 'ch_de', 'ch_fr', 'ch_it', 'cis_en', 'cis_ru', 'cz', 'de', 'dk', 'ee', 'eg_ar', 'eg_en', 'es', 'fi', 'fr', 'gr_el', 'gr_en', 'hu', 'ie', 'il_en', 'il_he', 'iq', 'is', 'it', 'kw_ar', 'kw_en', 'lt', 'lu_de', 'lu_en', 'lu_fr', 'lv', 'mena_ar', 'mena_en', 'ng', 'nl', 'no', 'pl', 'pt', 'qa_ar', 'qa_en', 'ro', 'ru', 'sa_en', 'sa_ar', 'se', 'si', 'sk', 'tr', 'ua', 'uk', 'za'];\nconst AMERICAS = ['us', 'ar', 'br', 'ca', 'ca_fr', 'cl', 'co', 'cr', 'ec', 'gt', 'la', 'mx', 'pe', 'pr'];\nconst JP = ['jp'];\nconst REGIONS = { APAC, EMEA, AMERICAS, JP };\nconst localeCode = getConfig()?.locale?.prefix?.substring(1) || 'us';\nconst regionCode = Object.keys(REGIONS)\n  .find((r) => REGIONS[r]?.includes(localeCode))?.toLowerCase() || null;\n\nexport const isDisabled = (event, searchParams) => {\n  if (!event) return false;\n  if (event.locales && !event.locales.includes(localeCode)) return true;\n  const currentDate = searchParams?.get('instant') ? new Date(searchParams.get('instant')) : new Date();\n  if ((!event.start && event.end) || (!event.end && event.start)) return true;\n  return Boolean(event.start && event.end\n    && (currentDate < event.start || currentDate > event.end));\n};\n\nconst isManifestWithinLocale = (locales) => {\n  if (!locales) return true;\n  return locales.split(';').map((locale) => locale.trim()).includes(localeCode);\n};\n\nconst getRegionalPromoManifests = (manifestNames, region, searchParams) => {\n  const attachedManifests = manifestNames\n    ? manifestNames.split(',')?.map((manifest) => manifest?.trim())\n    : [];\n\n  const schedule = getMetadata(region ? `${region}_schedule` : 'schedule');\n  if (!schedule) {\n    return [];\n  }\n  return schedule.split(',')\n    .map((manifest) => {\n      const [name, start, end, manifestPath, locales, cdtStart, cdtEnd] = manifest.trim().split('|').map((s) => s.trim());\n      if (attachedManifests.includes(name) && isManifestWithinLocale(locales)) {\n        const event = {\n          name,\n          start: GMTStringToLocalDate(start),\n          end: GMTStringToLocalDate(end),\n          cdtStart,\n          cdtEnd,\n        };\n        const disabled = isDisabled(event, searchParams);\n        return { manifestPath, disabled, event };\n      }\n      return null;\n    })\n    .filter((manifest) => manifest != null);\n};\n\nexport default function getPromoManifests(manifestNames, searchParams) {\n  const promoManifests = regionCode != null ? getRegionalPromoManifests(\n    manifestNames[`${regionCode}_manifestnames`],\n    regionCode,\n    searchParams,\n  ) : [];\n  const globalPromoManifests = getRegionalPromoManifests(\n    manifestNames.manifestnames,\n    null,\n    searchParams,\n  );\n  return [...promoManifests, ...globalPromoManifests];\n}\n"],
  "mappings": "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",
  "names": []
}
